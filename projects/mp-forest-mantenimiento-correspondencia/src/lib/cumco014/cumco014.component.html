<div class="ui-fluid">
  <p-tabView>
    <p-toast position="top-center"></p-toast>
    <p-tabPanel header="{{ 'CUMCO014.pestana1' | translate }}">

      <p-fieldset legend="{{ 'CUMCO014.titulo' | translate }}">

        <p>{{ 'CUMCO014.FILTROS.filtroRadicado' | translate }}</p>

        <div class="ui-g">
          <div class="ui-g-12">
            <div class="ui-inputgroup">
              <span class="ui-inputgroup-addon"><i class="pi pi-search" style="line-height: 1;"></i></span>
              <p-autoComplete [(ngModel)]="seleccionRadicado" field="codigoDescripcion" [immutable]="false" [suggestions]="listaRadicado" (completeMethod)="searchRadicado($event)"
              [dropdown]="true" [forceSelection]="true" (onSelect)="actualizarTablaRadicado()">
              </p-autoComplete>
              <p-button icon="pi pi-times" (click)="onClicBorrarAutoCompleteRadicado()"></p-button>
            </div>
          </div>
        </div>



        <br>
        <br>


        <!-- Start Table -->
        <p-table [columns]="cols" [value]="tablaTipoRadicado"
        [paginator]="true" [rows]="5" [rowsPerPageOptions]="[5,10,20]"
        selectionMode="single" [(selection)]="seleccionTablaRadicado"
        (onRowSelect)="onRowSelect($event, seleccionTablaRadicado)">

          <!-- Table Caption -->
          <ng-template pTemplate="caption">
            <div class="ui-helper-clearfix menu-sup-grid">
              <!-- Buttons -->
              <div class="button-sup-grid">
                <p-button label="{{ 'BOTONESTABLA.agregar' | translate }}" icon="pi pi-plus" iconPos="left" style="float:left; margin-left: 2px;" (click)="onClicAgregarRadicado()"></p-button>
                <p-button label="{{ 'BOTONESTABLA.eliminar' | translate }}" icon="pi pi-minus" iconPos="left" style="float:left; margin-left: 2px;" (click)="onClicEliminarRadicado()"></p-button>
                <p-button label="{{ 'BOTONESTABLA.guardar' | translate }}" icon="pi pi-save" iconPos="left" style="float:left; margin-left: 2px;" (click)="onClicGuardarRadicado()"></p-button>
              </div>
            </div>
          </ng-template>

          <!-- Table Heardes -->
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns">
                {{col.header}}
              </th>
            </tr>
          </ng-template>

          <!-- Table Content -->
          <ng-template pTemplate="body" let-row let-rowData let-columns="columns" let-rowIndex="rowIndex">
            <tr [pSelectableRow]="row" [pSelectableRowIndex]="rowIndex" [ngStyle]="{'background-color': row.state === 'delete'?'#FFBABA':''}">
              <td pEditableColumn *ngFor="let col of columns; let i = index" [attr.data-index]="i">

                <div [ngSwitch]="i">
                  <div *ngSwitchCase="0"> {{rowIndex}}</div>
                  <div *ngSwitchCase="1">
                    {{row.codigo}}
                  </div>
                  <div *ngSwitchCase="2">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input type="text" [(ngModel)]="row.descripcion" [disabled]="row.state === 'delete'" (focusout)="editedRadicado(rowIndex)" (keydown.enter)="editedRadicado(rowIndex)" [maxlength]="200">
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{row.descripcion}}
                    </ng-template>
                  </p-cellEditor>
                  </div>
                  <div *ngSwitchCase="3">
                    <p-cellEditor>
                      <ng-template pTemplate="input">
                        <p-dropdown [options]="listaRadicado" optionLabel="codigoDescripcion" [(ngModel)]="row.categoria" [disabled]="row.state === 'delete'" (onChange)="editedRadicado(rowIndex)"></p-dropdown>
                      </ng-template>
                      <ng-template pTemplate="output">
                        {{row.categoria.codigoDescripcion}}
                      </ng-template>
                    </p-cellEditor>

                  </div>
                  <div *ngSwitchCase="4" style="text-align: center">
                    <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>
                </div>


              </td>
            </tr>
          </ng-template>

        </p-table>
        <!-- End Table -->

      </p-fieldset>

      <p-fieldset legend="{{ 'CUMCO014.titulo2' | translate }}">

        <p>{{ 'CUMCO014.FILTROS.subRadicado' | translate }}</p>

        <div class="ui-g">
          <div class="ui-g-12">
            <div class="ui-inputgroup">
              <span class="ui-inputgroup-addon"><i class="pi pi-search" style="line-height: 1;"></i></span>
              <p-autoComplete [dropdown]="true" [required]="true" [forceSelection]="true"
                              placeholder="Ingrese aquÃ­ el Subtipo de radicado a filtrar"
                              [disabled]="seleccionTablaRadicado === undefined || seleccionTablaRadicado === null"
                              [(ngModel)]="seleccionSubRadicado" [suggestions]="suggestionsAutoCompleteSubTipoRadicado"
                              (completeMethod)="searchSubRadicado($event, seleccionTablaRadicado)"
                              (onSelect)="onSelectSubtipoRadicado()" >
              </p-autoComplete>
              <p-button icon="pi pi-times" (click)="onClicBorrarAutoCompleteSubRadicado()"
              [disabled]="seleccionTablaRadicado === undefined|| seleccionTablaRadicado === null"></p-button>
            </div>
          </div>
        </div>



        <br>
        <br>


        <!-- Start Table 2 -->
        <p-table [columns]="cols2" [value]="listaSubRadicado"
        [paginator]="true" [rows]="5" [rowsPerPageOptions]="[5,10,20]"
        selectionMode="single" [(selection)]="seleccionSubRadicado">

          <!-- Table Caption 2 -->
          <ng-template pTemplate="caption">
            <div class="ui-helper-clearfix menu-sup-grid">
              <!-- Buttons 2 -->
              <div class="button-sup-grid">
                <p-button label="{{ 'BOTONESTABLA.agregar' | translate }}" icon="pi pi-plus" iconPos="left" style="float:left; margin-left: 2px;" (click)="onClicAgregarSubRadicado()"
                [disabled]="seleccionTablaRadicado === undefined|| seleccionTablaRadicado === null"></p-button>
                <p-button label="{{ 'BOTONESTABLA.eliminar' | translate }}" icon="pi pi-minus" iconPos="left" style="float:left; margin-left: 2px;" (click)="onClicEliminarSubRadicado()"
                [disabled]="seleccionTablaRadicado === undefined|| seleccionTablaRadicado === null"></p-button>
                <p-button label="{{ 'BOTONESTABLA.guardar' | translate }}" icon="pi pi-save" iconPos="left" style="float:left; margin-left: 2px;" (click)="onClicGuardarSubRadicado()"
                [disabled]="seleccionTablaRadicado === undefined|| seleccionTablaRadicado === null"></p-button>
              </div>
            </div>
          </ng-template>

          <!-- Table Heardes 2 -->
          <ng-template pTemplate="header" let-columns>
            <tr>
              <th *ngFor="let col of columns">
                {{col.header}}
              </th>
            </tr>
          </ng-template>

          <!-- Table Content 2 -->
          <ng-template pTemplate="body" let-row let-rowData let-columns="columns" let-rowIndex="rowIndex">
            <tr [pSelectableRow]="row" [pSelectableRowIndex]="rowIndex" [ngStyle]="{'background-color': row.state === 'delete'?'#FFBABA':''}">
              <td pEditableColumn *ngFor="let col of columns; let i = index" [attr.data-index]="i">

                <div [ngSwitch]="i">
                  <div *ngSwitchCase="0"> {{row.tipoRadicado.codigo}}</div>

                  <div *ngSwitchCase="1">
                    {{row.tipoRadicado.descripcion}}
                  </div>

                  <div *ngSwitchCase="2">
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                     <p-autoComplete [dropdown]="true" [required]="true" [style]="{'width':'100%', 'height':'100%'}"
                                                            [(ngModel)]="tableTextAutoCompleteTramite"
                                                            [disabled]="row.postState === 'delete'"
                                                            [suggestions]="suggestionsAutoCompleteTramite"
                                                            (completeMethod)="searchFilterTramite($event)"
                                                            (onSelect)="onSelectTramite(rowData, rowIndex)">
                      </p-autoComplete>
                    </ng-template>
                    <ng-template pTemplate="output">
                      {{row.tramite.descripcion}}
                    </ng-template>
                  </p-cellEditor>
                  </div>

                  <div *ngSwitchCase="3">
                    <p-cellEditor>
                      <ng-template pTemplate="input">
                        <input type="number" [(ngModel)]="row.diasRequerimiento" [disabled]= "row.state === 'delete' || row.terminoRequerimiento === 0"
                        (focusout)="edited(rowIndex)" (keydown.enter)="edited(rowIndex)" [maxlength]="3" min="0">
                      </ng-template>
                      <ng-template pTemplate="output">
                        {{row.tipoRadicado.codigo}}
                      </ng-template>
                    </p-cellEditor>

                  </div>

                  <div *ngSwitchCase="4" style="text-align: center">
                    <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                  <div *ngSwitchCase="5"> <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                  <div *ngSwitchCase="6"> <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                  <div *ngSwitchCase="7"> <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                  <div *ngSwitchCase="8"> <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                  <div *ngSwitchCase="9"> <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                  <div *ngSwitchCase="10"> <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                  <div *ngSwitchCase="11"> <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true" (onChange) = "editedRadicado(rowIndex)"
                    [disabled]="row.state === 'delete'" (ngModelChange)="row.terminoRequerimiento = $event ? 1 : 0"></p-checkbox>
                  </div>

                </div>




              </td>
            </tr>
          </ng-template>

        </p-table>
        <!-- End Table 2 -->

      </p-fieldset>


    </p-tabPanel>
  </p-tabView>
</div>
