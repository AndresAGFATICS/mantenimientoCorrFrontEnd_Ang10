<div class="ui-fluid">

    <p-tabView>

        <!-- TAB SATART 1 -->
        <p-tabPanel header="{{ 'CUMCO020.pestana1' | translate }}">


            <p-fieldset legend="{{ 'CUMCO020.pField1' | translate }}">

                <p>{{ 'CUMCO020.FILTROS.filtroProceso' | translate }}</p>

                <div class="ui-g">
                    <div class="ui-g-12">
                        <div class="ui-inputgroup">
                            <span class="ui-inputgroup-addon"><i class="pi pi-search"
                                    style="line-height: 1;"></i></span>
                            <p-autoComplete [(ngModel)]="seleccionProcesoFilter" field="codigoNombre"
                                [suggestions]="suggestionsProcesoFilter" (completeMethod)="searchProcesoFilter($event)"
                                [dropdown]="true" (focusout)="focusOutProcesoFilter()"
                                (onSelect)="selectProcesoFilter($event)"
                                placeholder="{{ 'CUMCO020.FILTROS.filtroProcesoPlaceHolder' | translate }}">
                            </p-autoComplete>
                            <p-button icon="pi pi-times" (click)="onClicBorrarProcesoFilter()"></p-button>
                        </div>
                    </div>
                </div>

                <br>

                <p-messages [(value)]="msgs"></p-messages>

                <!-- Start Table 1 -->
                <p-table [columns]="cols" [value]="dataTable1" [paginator]="true" [(rows)]="nRowsTable1" [(first)]="pageTable1" (onRowSelect)="rowSelectTable1()"
                    [rowsPerPageOptions]="nRowsOptionsTable1" selectionMode="single" [(selection)]="selectedRowTable1" [loading]="loading1">

                    <!-- Table Column Width 1 -->
                    <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                            <col style="width:5%">
                        </colgroup>
                    </ng-template>


                    <!-- Table Caption 1 -->
                    <ng-template pTemplate="caption">
                        <div class="ui-helper-clearfix menu-sup-grid">
                            <!-- Buttons 1 -->
                            <div class="button-sup-grid">
                                <p-button label="{{ 'BOTONESTABLA.agregar' | translate }}" icon="pi pi-plus"
                                    iconPos="left" class="table_button" (click)="onClicAgregar1()">
                                </p-button>
                                <p-button label="{{ 'BOTONESTABLA.eliminar' | translate }}" icon="pi pi-minus"
                                    iconPos="left" class="table_button" (click)="onClicEliminar1()">
                                </p-button>
                                <p-button label="{{ 'BOTONESTABLA.guardar' | translate }}" icon="pi pi-save"
                                    iconPos="left" class="table_button" (click)="onClicGuardar1()">
                                </p-button>
                            </div>
                        </div>
                    </ng-template>

                    <!-- Table Heardes 1 -->
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                <div *ngIf="col.required; else loggedOut">
                                    <B>
                                      <FONT COLOR="red">*</FONT>
                                    </B>
                                    {{col.header}}
                                  </div>
                      
                                  <ng-template #loggedOut>
                                    {{col.header}}
                                  </ng-template>
                                <p-sortIcon [field]="col.field" ariaLabel="Activate to sort"
                                    ariaLabelDesc="Activate to sort in descending order"
                                    ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
                            </th>
                        </tr>
                    </ng-template>


                    <!-- Table Content 1 -->
                    <ng-template pTemplate="body" let-row let-rowData let-columns="columns" let-rowIndex="rowIndex">
                        <tr [pSelectableRow]="row" [pSelectableRowIndex]="rowIndex" [ngStyle]="gteRowColorState(row)">
                            <td pEditableColumn *ngFor="let col of columns; let i = index" [attr.data-index]="i">

                                <div [ngSwitch]="i">

                                    <div *ngSwitchCase="0"> {{rowIndex + 1}}</div>

                                    <div *ngSwitchCase="1">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                            <input type="text" [(ngModel)]="row.codigo" [disabled]="row.state === 'delete'"
                                              (focusout)="editedTable1()" (keydown.enter)="editedTable1(rowIndex)" [maxlength]="30">
                                          </ng-template>
                                          <ng-template pTemplate="output">
                                            {{row.codigo}}
                                          </ng-template>
                                        </p-cellEditor>
                                    </div>

                                    <div *ngSwitchCase="2">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                            <input type="text" [(ngModel)]="row.nombre" [disabled]="row.state === 'delete'"
                                              (focusout)="editedTable1()" (keydown.enter)="editedTable1(rowIndex)" [maxlength]="300">
                                          </ng-template>
                                          <ng-template pTemplate="output">
                                            {{row.nombre}}
                                          </ng-template>
                                        </p-cellEditor>
                                    </div>


                                    <div *ngSwitchCase="3">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                            <input type="text" [(ngModel)]="row.descripcion" [disabled]="row.state === 'delete'"
                                              (focusout)="editedTable1()" (keydown.enter)="editedTable1(rowIndex)" [maxlength]="200">
                                          </ng-template>
                                          <ng-template pTemplate="output">
                                            {{row.descripcion}}
                                          </ng-template>
                                        </p-cellEditor>
                                    </div>


                                    <div *ngSwitchCase="4" style="text-align: center">
                                        <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true"
                                          (ngModelChange)="row.activo = $event ? 1 : 0" (onChange)="editedTable1(rowIndex)"
                                          [disabled]="row.state==='delete'">
                                        </p-checkbox>
                                    </div>
            

                                </div>

                            </td>
                        </tr>
                    </ng-template>


                </p-table>
                <!-- End Table 1 -->

            </p-fieldset>

            <br>

            <p-fieldset legend="{{ 'CUMCO020.pField2' | translate }}">

                <p>{{ 'CUMCO020.FILTROS.filtroProcedimiento' | translate }}</p>

                <div class="ui-g">
                    <div class="ui-g-12">
                        <div class="ui-inputgroup">
                            <span class="ui-inputgroup-addon"><i class="pi pi-search"
                                    style="line-height: 1;"></i></span>
                            <p-autoComplete [(ngModel)]="seleccionProcedimientoFilter" field="codigoNombre"
                                [suggestions]="suggestionsProcedimientoFilter" (completeMethod)="searchProcedimientoFilter($event)"  [disabled]="selectedRowTable1 === undefined"
                                [dropdown]="true" (focusout)="focusOutProcedimientoFilter()"
                                (onSelect)="selectProcedimientoFilter($event)"
                                placeholder="{{ 'CUMCO020.FILTROS.filtroProcedimientoPlaceHolder' | translate }}">
                            </p-autoComplete>
                            <p-button icon="pi pi-times" (click)="onClicBorrarProcedimientoFilter()"></p-button>
                        </div>
                    </div>
                </div>

                <br>

                <p-messages [(value)]="msgs2"></p-messages>

                <!-- Start Table 2 -->
                <p-table [columns]="cols2" [value]="dataTable2" [paginator]="true" [(rows)]="nRowsTable2" [(first)]="pageTable2"
                    [rowsPerPageOptions]="nRowsOptionsTable2" selectionMode="single" [(selection)]="selectedRowTable2" [loading]="loading2">

                    <!-- Table Column Width 2 -->
                    <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                            <col style="width:5%">
                        </colgroup>
                    </ng-template>


                    <!-- Table Caption 2 -->
                    <ng-template pTemplate="caption">
                        <div class="ui-helper-clearfix menu-sup-grid">
                            <!-- Buttons 2 -->
                            <div class="button-sup-grid">
                                <p-button label="{{ 'BOTONESTABLA.agregar' | translate }}" icon="pi pi-plus"
                                    iconPos="left" class="table_button" (click)="onClicAgregar2()" [disabled]="selectedRowTable1 === undefined">
                                </p-button>
                                <p-button label="{{ 'BOTONESTABLA.eliminar' | translate }}" icon="pi pi-minus"
                                    iconPos="left" class="table_button" (click)="onClicEliminar2()" [disabled]="selectedRowTable1 === undefined">
                                </p-button>
                                <p-button label="{{ 'BOTONESTABLA.guardar' | translate }}" icon="pi pi-save"
                                    iconPos="left" class="table_button" (click)="onClicGuardar2()" [disabled]="selectedRowTable1 === undefined">
                                </p-button>
                            </div>
                        </div>
                    </ng-template>

                    <!-- Table Heardes 2 -->
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                <div *ngIf="col.required; else loggedOut">
                                    <B>
                                      <FONT COLOR="red">*</FONT>
                                    </B>
                                    {{col.header}}
                                  </div>
                      
                                  <ng-template #loggedOut>
                                    {{col.header}}
                                  </ng-template>
                                <p-sortIcon [field]="col.field" ariaLabel="Activate to sort"
                                    ariaLabelDesc="Activate to sort in descending order"
                                    ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
                            </th>
                        </tr>
                    </ng-template>


                    <!-- Table Content 2 -->
                    <ng-template pTemplate="body" let-row let-rowData let-columns="columns" let-rowIndex="rowIndex">
                        <tr [pSelectableRow]="row" [pSelectableRowIndex]="rowIndex" [ngStyle]="gteRowColorState(row)">
                            <td pEditableColumn *ngFor="let col of columns; let i = index" [attr.data-index]="i">

                                <div [ngSwitch]="i">

                                    <div *ngSwitchCase="0"> {{rowIndex + 1}}</div>


                                    <div *ngSwitchCase="1">
                                        {{row.codigoNombreProceso}}
                                    </div>


                                    <div *ngSwitchCase="2">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                            <input type="text" [(ngModel)]="row.codigo" [disabled]="row.state === 'delete'"
                                              (focusout)="editedTable2()" (keydown.enter)="editedTable2(rowIndex)" [maxlength]="30">
                                          </ng-template>
                                          <ng-template pTemplate="output">
                                            {{row.codigo}}
                                          </ng-template>
                                        </p-cellEditor>
                                    </div>


                                    <div *ngSwitchCase="3">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                            <input type="text" [(ngModel)]="row.nombre" [disabled]="row.state === 'delete'"
                                              (focusout)="editedTable2()" (keydown.enter)="editedTable2(rowIndex)" [maxlength]="300">
                                          </ng-template>
                                          <ng-template pTemplate="output">
                                            {{row.nombre}}
                                          </ng-template>
                                        </p-cellEditor>
                                    </div>

                                    <div *ngSwitchCase="4">
                                        <p-cellEditor>
                                          <ng-template pTemplate="input">
                                            <input type="text" [(ngModel)]="row.descripcion" [disabled]="row.state === 'delete'"
                                              (focusout)="editedTable2()" (keydown.enter)="editedTable2(rowIndex)" [maxlength]="200">
                                          </ng-template>
                                          <ng-template pTemplate="output">
                                            {{row.descripcion}}
                                          </ng-template>
                                        </p-cellEditor>
                                    </div>


                                    <div *ngSwitchCase="5" style="text-align: center">
                                        <p-checkbox name="groupname" [(ngModel)]="row.activo" [binary]="true"
                                          (ngModelChange)="row.activo = $event ? 1 : 0" (onChange)="editedTable2(rowIndex)"
                                          [disabled]="row.state==='delete'">
                                        </p-checkbox>
                                    </div>

                                    
                                </div>

                            </td>
                        </tr>
                    </ng-template>


                </p-table>
                <!-- End Table 2 -->

            </p-fieldset>


        </p-tabPanel>


        <!-- TAB SATART 2 -->
        <p-tabPanel header="{{ 'CUMCO020.pestana2' | translate }}">


            <p-fieldset legend="{{ 'CUMCO020.pField3' | translate }}">

                <p><FONT COLOR="red">*</FONT>{{ 'CUMCO020.FILTROS.filtroDependencia' | translate }}</p>

                <div class="ui-g">
                    <div class="ui-g-12">
                        <div class="ui-inputgroup">
                            <span class="ui-inputgroup-addon"><i class="pi pi-search"
                                    style="line-height: 1;"></i></span>
                            <p-autoComplete [(ngModel)]="seleccionDependenciaFilter" field="nombreCodigoGuion"
                                [suggestions]="suggestionsDependenciaFilter" (completeMethod)="searchDependenciaFilter($event)"
                                [dropdown]="true" (focusout)="focusOutDepenenciaFilter()"
                                (onSelect)="selectDependenciaFilter($event)"
                                placeholder="{{ 'CUMCO020.FILTROS.filtroDependenciaPlaceHolder' | translate }}">
                            </p-autoComplete>
                            <p-button icon="pi pi-times" (click)="onClicBorrarDependenciaFilter()"></p-button>
                        </div>
                    </div>
                </div>

                <br>

                <p-messages [(value)]="msgs"></p-messages>

                <!-- Start Table 3 -->
                <p-table [columns]="cols3" [value]="dataTable3" [paginator]="true" [(rows)]="nRowsTable3" [(first)]="startRegisterTable3"  (onRowSelect)="rowSelectTable3()"
                    [rowsPerPageOptions]="nRowsOptionsTable3" selectionMode="single" [(selection)]="selectedRowTable3" 
                    [loading]="loading3" [lazy]="true" [totalRecords]="totalRecords3" (onLazyLoad)="loadDataTable3($event)">

                    <!-- Table Column Width 3 -->
                    <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                            <col style="width:5%">
                        </colgroup>
                    </ng-template>


                    <!-- Table Caption 3 -->
                    <ng-template pTemplate="caption">
                        <div class="ui-helper-clearfix menu-sup-grid">
                            <!-- Buttons 3 -->
                            <div class="button-sup-grid">
                                <p-button label="{{ 'BOTONESTABLA.agregar' | translate }}" icon="pi pi-plus"
                                    iconPos="left" class="table_button" (click)="onClicAgregar3()" [disabled]="!seleccionDependenciaFilter">
                                </p-button>
                                <p-button label="{{ 'BOTONESTABLA.eliminar' | translate }}" icon="pi pi-minus"
                                    iconPos="left" class="table_button" (click)="onClicEliminar3()" [disabled]="!seleccionDependenciaFilter">
                                </p-button>
                                <p-button label="{{ 'BOTONESTABLA.guardar' | translate }}" icon="pi pi-save"
                                    iconPos="left" class="table_button" (click)="onClicGuardar3()" [disabled]="!seleccionDependenciaFilter">
                                </p-button>
                            </div>
                        </div>
                    </ng-template>

                    <!-- Table Heardes 3 -->
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                <div *ngIf="col.required; else loggedOut">
                                    <B>
                                      <FONT COLOR="red">*</FONT>
                                    </B>
                                    {{col.header}}
                                  </div>
                      
                                  <ng-template #loggedOut>
                                    {{col.header}}
                                  </ng-template>
                                <p-sortIcon [field]="col.field" ariaLabel="Activate to sort"
                                    ariaLabelDesc="Activate to sort in descending order"
                                    ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
                            </th>
                        </tr>
                    </ng-template>


                    <!-- Table Content 3 -->
                    <ng-template pTemplate="body" let-row let-rowData let-columns="columns" let-rowIndex="rowIndex">
                        <tr [pSelectableRow]="row" [pSelectableRowIndex]="rowIndex" [ngStyle]="gteRowColorState(row)">
                            <td pEditableColumn *ngFor="let col of columns; let i = index" [attr.data-index]="i">

                                <div [ngSwitch]="i">

                                    <div *ngSwitchCase="0"> {{rowIndex + 1}}</div>

                                    <div *ngSwitchCase="1">
                                        <p-cellEditor>
                                            <ng-template pTemplate="input">
                                                <p-autoComplete field="codigoNombre" (onSelect)="pruebaOnselect(rowIndex)" (click)="onClickElminiarSelected3()"
                                                  [(ngModel)]="row.proceso" (focusout)="focusOutTablaProcesoTabla3(rowIndex)"
                                                  [suggestions]="suggestionsProcesoFilter" (completeMethod)="searchProcesoFilter($event)" [dropdown]="true" >
                                                </p-autoComplete>
                                              </ng-template>
                                          <ng-template pTemplate="output">
                                            {{row.proceso.codigoNombre}}
                                          </ng-template>
                                        </p-cellEditor>
                                    </div>            

                                </div>

                            </td>
                        </tr>
                    </ng-template>


                </p-table>
                <!-- End Table 3 -->

            </p-fieldset>


            <br>

            <p-fieldset legend="{{ 'CUMCO020.pField4' | translate }}">

                <p>{{ 'CUMCO020.FILTROS.filtroProcedimiento' | translate }}</p>

                <div class="ui-g">
                    <div class="ui-g-12">
                        <div class="ui-inputgroup">
                            <span class="ui-inputgroup-addon"><i class="pi pi-search"
                                    style="line-height: 1;"></i></span>
                            <p-autoComplete [(ngModel)]="seleccionProcedimientoFilter2" field="codigoNombre" [disabled]="!selectedRowTable3 || selectedRowTable3.state === 'new'"
                                [suggestions]="suggestionsProcedimientoFilter2" (completeMethod)="searchProcedimientoFilter2($event)"
                                [dropdown]="true" (focusout)="focusOutProcedimientoFilter2()"
                                (onSelect)="selectProcedimientoFilter2($event)"
                                placeholder="{{ 'CUMCO020.FILTROS.filtroProcedimientoPlaceHolder' | translate }}">
                            </p-autoComplete>
                            <p-button icon="pi pi-times" (click)="onClicBorrarProcedimientoFilter2()"></p-button>
                        </div>
                    </div>
                </div>

                <br>

                <p-messages [(value)]="msgs2"></p-messages>

                <!-- Start Table 4 -->
                <p-table [columns]="cols4" [value]="dataTable4" [paginator]="true" [(rows)]="nRowsTable4" [(first)]="pageTable4" 
                    [rowsPerPageOptions]="nRowsOptionsTable4" [loading]="loading4">



                    <!-- Table Caption 4 -->
                    <ng-template pTemplate="caption">
                        <div class="ui-helper-clearfix menu-sup-grid">
                            <!-- Buttons 4 -->
                            <div class="button-sup-grid">
                                <p-button label="{{ 'BOTONESTABLA.guardar' | translate }}" icon="pi pi-save" 
                                    iconPos="left" class="table_button" (click)="onClicGuardar4()" [disabled]="!selectedRowTable3 || selectedRowTable3.state === 'new'">
                                </p-button>
                            </div>
                        </div>
                    </ng-template>

                    <!-- Table Heardes 4 -->
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th style="width: 3rem">
                                <p-checkbox  [(ngModel)]="allSelect" [binary]="true" (onChange)="onChageAll($event)"></p-checkbox>
                            </th>
                            <th> {{ 'CUMCO020.TABLA4.headerTabla1' | translate }} </th>
                        </tr>
                    </ng-template>


                    <!-- Table Content 4 -->
                    <ng-template pTemplate="body" let-row let-rowData let-columns="columns" let-rowIndex="rowIndex">
                        <tr [pSelectableRow]="row" [pSelectableRowIndex]="rowIndex" [ngStyle]="gteRowColorState(row)">
                            <td pEditableColumn *ngFor="let col of columns; let i = index" [attr.data-index]="i">

                                <div [ngSwitch]="i">

                                    <div *ngSwitchCase="0" style="text-align: center"> 
                                        <p-checkbox  [(ngModel)]="row.rel" 
                                        [binary]="true" (ngModelChange)="row.rel = $event ? 1 : 0"
                                        (onChange)="onChageProcesoRow(rowIndex)" >
                                        </p-checkbox>
                                    </div>

                                    <div *ngSwitchCase="1">

                                        <b *ngIf="row.response.isRelProcDepBorrador === 1 || row.response.isRelProcDepRadciado === 1; else elseBlock" style="font-size:14px">{{row.porcedimiento.codigoNombre}}</b>
                                        <ng-template #elseBlock>
                                            {{row.porcedimiento.codigoNombre}}
                                        </ng-template>

                                        
                                    </div>            

                                </div>

                            </td>
                        </tr>
                    </ng-template>


                </p-table>
                <!-- End Table 4 -->

            </p-fieldset>




        </p-tabPanel>

    </p-tabView>
</div>